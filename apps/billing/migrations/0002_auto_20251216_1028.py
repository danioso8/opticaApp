# Generated by Django 3.2.25 on 2025-12-16 15:28

import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('organizations', '0012_subscriptionplan_max_organizations'),
        ('billing', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Supplier',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(help_text='Código único del proveedor', max_length=50, verbose_name='Código Proveedor')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre/Razón Social')),
                ('nombre_comercial', models.CharField(blank=True, max_length=200, verbose_name='Nombre Comercial')),
                ('tipo_documento', models.CharField(choices=[('NIT', 'NIT'), ('CC', 'Cédula de Ciudadanía'), ('CE', 'Cédula de Extranjería'), ('PA', 'Pasaporte')], default='NIT', max_length=10, verbose_name='Tipo de Documento')),
                ('numero_documento', models.CharField(max_length=50, verbose_name='Número de Documento')),
                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),
                ('telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono')),
                ('celular', models.CharField(blank=True, max_length=20, verbose_name='Celular')),
                ('sitio_web', models.URLField(blank=True, verbose_name='Sitio Web')),
                ('direccion', models.TextField(blank=True, verbose_name='Dirección')),
                ('ciudad', models.CharField(blank=True, max_length=100, verbose_name='Ciudad')),
                ('pais', models.CharField(default='Colombia', max_length=100, verbose_name='País')),
                ('nombre_contacto', models.CharField(blank=True, max_length=200, verbose_name='Nombre Contacto Principal')),
                ('cargo_contacto', models.CharField(blank=True, max_length=100, verbose_name='Cargo')),
                ('email_contacto', models.EmailField(blank=True, max_length=254, verbose_name='Email Contacto')),
                ('telefono_contacto', models.CharField(blank=True, max_length=20, verbose_name='Teléfono Contacto')),
                ('condiciones_pago', models.TextField(blank=True, help_text='Ej: 30 días, Contado, etc.', verbose_name='Condiciones de Pago')),
                ('descuento_comercial', models.DecimalField(decimal_places=2, default=0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='Descuento Comercial %')),
                ('tiempo_entrega_dias', models.IntegerField(blank=True, null=True, verbose_name='Tiempo de Entrega (días)')),
                ('categoria', models.CharField(blank=True, choices=[('MONTURAS', 'Monturas'), ('LENTES', 'Lentes'), ('ACCESORIOS', 'Accesorios'), ('EQUIPOS', 'Equipos Ópticos'), ('INSUMOS', 'Insumos'), ('OTROS', 'Otros')], max_length=100, verbose_name='Categoría Principal')),
                ('calificacion', models.IntegerField(blank=True, help_text='Calificación del proveedor', null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)], verbose_name='Calificación (1-5 estrellas)')),
                ('notas', models.TextField(blank=True, verbose_name='Notas Internas')),
                ('is_active', models.BooleanField(default=True, verbose_name='Activo')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('organization', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='supplier_set', to='organizations.organization', verbose_name='Organización')),
            ],
            options={
                'verbose_name': 'Proveedor',
                'verbose_name_plural': 'Proveedores',
                'ordering': ['nombre'],
            },
        ),
        migrations.CreateModel(
            name='InvoiceProduct',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(help_text='Código único del producto', max_length=100, verbose_name='Código/SKU')),
                ('codigo_barras', models.CharField(blank=True, max_length=100, verbose_name='Código de Barras/EAN')),
                ('nombre', models.CharField(max_length=300, verbose_name='Nombre del Producto')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción Detallada')),
                ('descripcion_corta', models.CharField(blank=True, max_length=200, verbose_name='Descripción Corta')),
                ('categoria', models.CharField(choices=[('MONTURAS', 'Monturas'), ('LENTES_FORMULA', 'Lentes con Fórmula'), ('LENTES_SOL', 'Lentes de Sol'), ('LENTES_CONTACTO', 'Lentes de Contacto'), ('ACCESORIOS', 'Accesorios'), ('LIQUIDOS', 'Líquidos y Soluciones'), ('ESTUCHES', 'Estuches'), ('SERVICIOS', 'Servicios Ópticos'), ('OTROS', 'Otros')], max_length=100, verbose_name='Categoría')),
                ('subcategoria', models.CharField(blank=True, max_length=100, verbose_name='Subcategoría')),
                ('marca', models.CharField(blank=True, max_length=100, verbose_name='Marca')),
                ('modelo', models.CharField(blank=True, max_length=100, verbose_name='Modelo')),
                ('precio_compra', models.DecimalField(decimal_places=2, default=0, help_text='Precio de compra al proveedor', max_digits=12, validators=[django.core.validators.MinValueValidator(0)], verbose_name='Precio de Compra')),
                ('precio_venta', models.DecimalField(decimal_places=2, help_text='Precio al público', max_digits=12, validators=[django.core.validators.MinValueValidator(0)], verbose_name='Precio de Venta')),
                ('precio_mayorista', models.DecimalField(decimal_places=2, default=0, help_text='Precio para venta al por mayor', max_digits=12, validators=[django.core.validators.MinValueValidator(0)], verbose_name='Precio Mayorista')),
                ('margen_utilidad', models.DecimalField(decimal_places=2, default=0, help_text='Calculado automáticamente', max_digits=5, verbose_name='Margen de Utilidad %')),
                ('aplica_iva', models.BooleanField(default=True, verbose_name='Aplica IVA')),
                ('porcentaje_iva', models.DecimalField(decimal_places=2, default=19.0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='% IVA')),
                ('tipo_inventario', models.CharField(choices=[('FISICO', 'Producto Físico'), ('SERVICIO', 'Servicio'), ('DIGITAL', 'Producto Digital')], default='FISICO', max_length=20, verbose_name='Tipo de Inventario')),
                ('stock_actual', models.IntegerField(default=0, verbose_name='Stock Actual')),
                ('stock_minimo', models.IntegerField(default=5, help_text='Alerta cuando llegue a este nivel', verbose_name='Stock Mínimo')),
                ('stock_maximo', models.IntegerField(default=100, verbose_name='Stock Máximo')),
                ('ubicacion_fisica', models.CharField(blank=True, help_text='Ej: Estante A-3, Bodega 2', max_length=100, verbose_name='Ubicación Física')),
                ('material', models.CharField(blank=True, max_length=100, verbose_name='Material')),
                ('color', models.CharField(blank=True, max_length=50, verbose_name='Color')),
                ('tamanio', models.CharField(blank=True, help_text='Ej: 52-18-140 para monturas', max_length=50, verbose_name='Tamaño')),
                ('genero', models.CharField(blank=True, choices=[('UNISEX', 'Unisex'), ('HOMBRE', 'Hombre'), ('MUJER', 'Mujer'), ('NIÑO', 'Niño')], max_length=20, verbose_name='Género')),
                ('especificaciones', models.JSONField(blank=True, default=dict, help_text='Datos adicionales en formato JSON', verbose_name='Especificaciones Técnicas')),
                ('imagen_principal', models.ImageField(blank=True, null=True, upload_to='products/images/', verbose_name='Imagen Principal')),
                ('imagen_2', models.ImageField(blank=True, null=True, upload_to='products/images/', verbose_name='Imagen 2')),
                ('imagen_3', models.ImageField(blank=True, null=True, upload_to='products/images/', verbose_name='Imagen 3')),
                ('imagen_4', models.ImageField(blank=True, null=True, upload_to='products/images/', verbose_name='Imagen 4')),
                ('slug', models.SlugField(blank=True, max_length=200, verbose_name='URL Amigable')),
                ('meta_descripcion', models.TextField(blank=True, max_length=160, verbose_name='Meta Descripción SEO')),
                ('palabras_clave', models.CharField(blank=True, help_text='Separadas por comas', max_length=200, verbose_name='Palabras Clave')),
                ('is_active', models.BooleanField(default=True, verbose_name='Producto Activo')),
                ('is_featured', models.BooleanField(default=False, verbose_name='Producto Destacado')),
                ('permitir_venta_sin_stock', models.BooleanField(default=False, verbose_name='Permitir Venta sin Stock')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('organization', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='invoiceproduct_set', to='organizations.organization', verbose_name='Organización')),
                ('supplier', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='products', to='billing.supplier', verbose_name='Proveedor')),
            ],
            options={
                'verbose_name': 'Producto',
                'verbose_name_plural': 'Productos',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='InvoiceConfiguration',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('iva_porcentaje', models.DecimalField(decimal_places=2, default=19.0, help_text='Porcentaje de IVA (0-100)', max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='% IVA')),
                ('aplicar_iva_automatico', models.BooleanField(default=True, help_text='Calcular IVA automáticamente en productos', verbose_name='Aplicar IVA automático')),
                ('descuento_maximo_porcentaje', models.DecimalField(decimal_places=2, default=20.0, help_text='Descuento máximo permitido por factura', max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='Descuento Máximo %')),
                ('permitir_descuento_items', models.BooleanField(default=True, help_text='Permitir aplicar descuentos a items individuales', verbose_name='Permitir descuento por item')),
                ('aplicar_retefuente', models.BooleanField(default=False, help_text='Calcular retención en la fuente', verbose_name='Aplicar Retención en la Fuente')),
                ('retefuente_porcentaje', models.DecimalField(decimal_places=2, default=2.5, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='% Retención Fuente')),
                ('aplicar_reteiva', models.BooleanField(default=False, help_text='Calcular retención de IVA', verbose_name='Aplicar Retención IVA')),
                ('reteiva_porcentaje', models.DecimalField(decimal_places=2, default=15.0, max_digits=5, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)], verbose_name='% Retención IVA')),
                ('prefijo_factura', models.CharField(default='FE', help_text='Prefijo para número de factura (Ej: FE, INV)', max_length=10, verbose_name='Prefijo Factura')),
                ('siguiente_numero', models.IntegerField(default=1, help_text='Próximo número de factura a generar', verbose_name='Siguiente Número')),
                ('nota_predeterminada', models.TextField(blank=True, help_text='Nota que aparece en todas las facturas', verbose_name='Nota Predeterminada')),
                ('terminos_condiciones', models.TextField(blank=True, help_text='Términos y condiciones de venta', verbose_name='Términos y Condiciones')),
                ('metodos_pago_disponibles', models.JSONField(default=list, help_text='Lista de métodos de pago aceptados', verbose_name='Métodos de Pago Disponibles')),
                ('logo_factura', models.ImageField(blank=True, null=True, upload_to='billing/logos/', verbose_name='Logo para Factura')),
                ('color_principal', models.CharField(default='#3B82F6', help_text='Color hexadecimal (#RRGGBB)', max_length=7, verbose_name='Color Principal')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('organization', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='invoiceconfiguration_set', to='organizations.organization', verbose_name='Organización')),
            ],
            options={
                'verbose_name': 'Configuración de Facturación',
                'verbose_name_plural': 'Configuraciones de Facturación',
            },
        ),
        migrations.AddIndex(
            model_name='supplier',
            index=models.Index(fields=['organization', 'is_active'], name='billing_sup_organiz_b55ce4_idx'),
        ),
        migrations.AddIndex(
            model_name='supplier',
            index=models.Index(fields=['organization', 'numero_documento'], name='billing_sup_organiz_d4843a_idx'),
        ),
        migrations.AddIndex(
            model_name='supplier',
            index=models.Index(fields=['categoria'], name='billing_sup_categor_a4d864_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='supplier',
            unique_together={('organization', 'codigo')},
        ),
        migrations.AddIndex(
            model_name='invoiceproduct',
            index=models.Index(fields=['organization', 'is_active'], name='billing_inv_organiz_a54ed2_idx'),
        ),
        migrations.AddIndex(
            model_name='invoiceproduct',
            index=models.Index(fields=['organization', 'categoria'], name='billing_inv_organiz_60069a_idx'),
        ),
        migrations.AddIndex(
            model_name='invoiceproduct',
            index=models.Index(fields=['codigo_barras'], name='billing_inv_codigo__528f48_idx'),
        ),
        migrations.AddIndex(
            model_name='invoiceproduct',
            index=models.Index(fields=['marca'], name='billing_inv_marca_6c5353_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='invoiceproduct',
            unique_together={('organization', 'codigo')},
        ),
        migrations.AlterUniqueTogether(
            name='invoiceconfiguration',
            unique_together={('organization',)},
        ),
    ]
