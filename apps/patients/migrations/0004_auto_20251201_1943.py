# Generated by Django 3.2.25 on 2025-12-02 00:43

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        ('organizations', '0001_initial'),
        ('patients', '0003_merge_20251201_1927'),
    ]

    operations = [
        migrations.CreateModel(
            name='ClinicalHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateField(verbose_name='Fecha del Examen')),
                ('doctor', models.CharField(blank=True, max_length=200, verbose_name='Médico/Optómetra')),
                ('chief_complaint', models.TextField(blank=True, verbose_name='Motivo de Consulta')),
                ('current_illness', models.TextField(blank=True, verbose_name='Enfermedad Actual')),
                ('blurred_vision', models.BooleanField(default=False, verbose_name='Visión Borrosa')),
                ('eye_pain', models.BooleanField(default=False, verbose_name='Dolor Ocular')),
                ('headaches', models.BooleanField(default=False, verbose_name='Cefaleas')),
                ('photophobia', models.BooleanField(default=False, verbose_name='Fotofobia')),
                ('diplopia', models.BooleanField(default=False, verbose_name='Diplopía (Visión Doble)')),
                ('tearing', models.BooleanField(default=False, verbose_name='Lagrimeo')),
                ('redness', models.BooleanField(default=False, verbose_name='Enrojecimiento')),
                ('itching', models.BooleanField(default=False, verbose_name='Picazón')),
                ('floaters', models.BooleanField(default=False, verbose_name='Moscas Volantes')),
                ('halos', models.BooleanField(default=False, verbose_name='Halos de Luz')),
                ('symptoms_notes', models.TextField(blank=True, verbose_name='Notas de Síntomas')),
                ('previous_eye_surgery', models.BooleanField(default=False, verbose_name='Cirugía Ocular Previa')),
                ('surgery_details', models.TextField(blank=True, verbose_name='Detalles de Cirugías')),
                ('previous_glasses', models.BooleanField(default=False, verbose_name='Usa Lentes Previos')),
                ('glasses_since', models.CharField(blank=True, max_length=50, verbose_name='Usa Lentes Desde')),
                ('previous_contact_lenses', models.BooleanField(default=False, verbose_name='Uso de Lentes de Contacto')),
                ('family_glaucoma', models.BooleanField(default=False, verbose_name='Glaucoma (Familiar)')),
                ('family_cataracts', models.BooleanField(default=False, verbose_name='Cataratas (Familiar)')),
                ('family_macular_degeneration', models.BooleanField(default=False, verbose_name='Degeneración Macular (Familiar)')),
                ('family_diabetes', models.BooleanField(default=False, verbose_name='Diabetes (Familiar)')),
                ('family_hypertension', models.BooleanField(default=False, verbose_name='Hipertensión (Familiar)')),
                ('family_history_notes', models.TextField(blank=True, verbose_name='Notas Antecedentes Familiares')),
                ('occupation_visual_demand', models.CharField(blank=True, choices=[('high', 'Alta (Computadora, lectura)'), ('medium', 'Media'), ('low', 'Baja')], max_length=50, verbose_name='Demanda Visual Ocupacional')),
                ('screen_hours_daily', models.IntegerField(blank=True, null=True, verbose_name='Horas Diarias de Pantalla')),
                ('reading_hours_daily', models.IntegerField(blank=True, null=True, verbose_name='Horas Diarias de Lectura')),
                ('va_od_sc_distance', models.CharField(blank=True, help_text='Ej: 20/20, 20/40', max_length=20, verbose_name='AV OD SC Lejos')),
                ('va_od_sc_near', models.CharField(blank=True, max_length=20, verbose_name='AV OD SC Cerca')),
                ('va_od_cc_distance', models.CharField(blank=True, max_length=20, verbose_name='AV OD CC Lejos')),
                ('va_od_cc_near', models.CharField(blank=True, max_length=20, verbose_name='AV OD CC Cerca')),
                ('va_os_sc_distance', models.CharField(blank=True, max_length=20, verbose_name='AV OS SC Lejos')),
                ('va_os_sc_near', models.CharField(blank=True, max_length=20, verbose_name='AV OS SC Cerca')),
                ('va_os_cc_distance', models.CharField(blank=True, max_length=20, verbose_name='AV OS CC Lejos')),
                ('va_os_cc_near', models.CharField(blank=True, max_length=20, verbose_name='AV OS CC Cerca')),
                ('va_ou_distance', models.CharField(blank=True, max_length=20, verbose_name='AV OU Lejos')),
                ('va_ou_near', models.CharField(blank=True, max_length=20, verbose_name='AV OU Cerca')),
                ('refraction_od_sphere', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OD Esfera')),
                ('refraction_od_cylinder', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OD Cilindro')),
                ('refraction_od_axis', models.IntegerField(blank=True, help_text='0-180°', null=True, verbose_name='OD Eje')),
                ('refraction_od_add', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True, verbose_name='OD Adición')),
                ('refraction_od_prism', models.CharField(blank=True, max_length=20, verbose_name='OD Prisma')),
                ('refraction_os_sphere', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OS Esfera')),
                ('refraction_os_cylinder', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OS Cilindro')),
                ('refraction_os_axis', models.IntegerField(blank=True, help_text='0-180°', null=True, verbose_name='OS Eje')),
                ('refraction_os_add', models.DecimalField(blank=True, decimal_places=2, max_digits=4, null=True, verbose_name='OS Adición')),
                ('refraction_os_prism', models.CharField(blank=True, max_length=20, verbose_name='OS Prisma')),
                ('pd_distance', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='DP Lejos (mm)')),
                ('pd_near', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='DP Cerca (mm)')),
                ('pd_od', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='DP OD')),
                ('pd_os', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='DP OS')),
                ('keratometry_od_k1', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OD K1')),
                ('keratometry_od_k1_axis', models.IntegerField(blank=True, null=True, verbose_name='OD K1 Eje')),
                ('keratometry_od_k2', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OD K2')),
                ('keratometry_od_k2_axis', models.IntegerField(blank=True, null=True, verbose_name='OD K2 Eje')),
                ('keratometry_os_k1', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OS K1')),
                ('keratometry_os_k1_axis', models.IntegerField(blank=True, null=True, verbose_name='OS K1 Eje')),
                ('keratometry_os_k2', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True, verbose_name='OS K2')),
                ('keratometry_os_k2_axis', models.IntegerField(blank=True, null=True, verbose_name='OS K2 Eje')),
                ('iop_od', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='PIO OD (mmHg)')),
                ('iop_os', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True, verbose_name='PIO OS (mmHg)')),
                ('iop_method', models.CharField(blank=True, choices=[('goldman', 'Goldman'), ('air_puff', 'Aire (Soplo)'), ('tonopen', 'Tonopen'), ('other', 'Otro')], max_length=50, verbose_name='Método de Tonometría')),
                ('biomicroscopy_od_lids', models.TextField(blank=True, verbose_name='OD Párpados')),
                ('biomicroscopy_od_conjunctiva', models.TextField(blank=True, verbose_name='OD Conjuntiva')),
                ('biomicroscopy_od_cornea', models.TextField(blank=True, verbose_name='OD Córnea')),
                ('biomicroscopy_od_anterior_chamber', models.TextField(blank=True, verbose_name='OD Cámara Anterior')),
                ('biomicroscopy_od_iris', models.TextField(blank=True, verbose_name='OD Iris')),
                ('biomicroscopy_od_lens', models.TextField(blank=True, verbose_name='OD Cristalino')),
                ('biomicroscopy_os_lids', models.TextField(blank=True, verbose_name='OS Párpados')),
                ('biomicroscopy_os_conjunctiva', models.TextField(blank=True, verbose_name='OS Conjuntiva')),
                ('biomicroscopy_os_cornea', models.TextField(blank=True, verbose_name='OS Córnea')),
                ('biomicroscopy_os_anterior_chamber', models.TextField(blank=True, verbose_name='OS Cámara Anterior')),
                ('biomicroscopy_os_iris', models.TextField(blank=True, verbose_name='OS Iris')),
                ('biomicroscopy_os_lens', models.TextField(blank=True, verbose_name='OS Cristalino')),
                ('fundoscopy_od_vitreous', models.TextField(blank=True, verbose_name='OD Vítreo')),
                ('fundoscopy_od_optic_disc', models.TextField(blank=True, verbose_name='OD Disco Óptico')),
                ('fundoscopy_od_macula', models.TextField(blank=True, verbose_name='OD Mácula')),
                ('fundoscopy_od_vessels', models.TextField(blank=True, verbose_name='OD Vasos')),
                ('fundoscopy_od_periphery', models.TextField(blank=True, verbose_name='OD Periferia')),
                ('fundoscopy_os_vitreous', models.TextField(blank=True, verbose_name='OS Vítreo')),
                ('fundoscopy_os_optic_disc', models.TextField(blank=True, verbose_name='OS Disco Óptico')),
                ('fundoscopy_os_macula', models.TextField(blank=True, verbose_name='OS Mácula')),
                ('fundoscopy_os_vessels', models.TextField(blank=True, verbose_name='OS Vasos')),
                ('fundoscopy_os_periphery', models.TextField(blank=True, verbose_name='OS Periferia')),
                ('motility_od', models.TextField(blank=True, help_text='Movimientos extraoculares', verbose_name='Motilidad OD')),
                ('motility_os', models.TextField(blank=True, verbose_name='Motilidad OS')),
                ('cover_test', models.TextField(blank=True, verbose_name='Test de Cover')),
                ('convergence', models.CharField(blank=True, max_length=100, verbose_name='Convergencia')),
                ('color_vision_od', models.CharField(blank=True, choices=[('normal', 'Normal'), ('abnormal', 'Anormal'), ('not_tested', 'No Evaluado')], max_length=50, verbose_name='Visión de Colores OD')),
                ('color_vision_os', models.CharField(blank=True, choices=[('normal', 'Normal'), ('abnormal', 'Anormal'), ('not_tested', 'No Evaluado')], max_length=50, verbose_name='Visión de Colores OS')),
                ('color_vision_test', models.CharField(blank=True, help_text='Ej: Ishihara', max_length=50, verbose_name='Test Utilizado')),
                ('diagnosis', models.TextField(blank=True, verbose_name='Diagnóstico')),
                ('dx_myopia', models.BooleanField(default=False, verbose_name='Miopía')),
                ('dx_hyperopia', models.BooleanField(default=False, verbose_name='Hipermetropía')),
                ('dx_astigmatism', models.BooleanField(default=False, verbose_name='Astigmatismo')),
                ('dx_presbyopia', models.BooleanField(default=False, verbose_name='Presbicia')),
                ('dx_amblyopia', models.BooleanField(default=False, verbose_name='Ambliopía')),
                ('dx_strabismus', models.BooleanField(default=False, verbose_name='Estrabismo')),
                ('dx_cataracts', models.BooleanField(default=False, verbose_name='Cataratas')),
                ('dx_glaucoma', models.BooleanField(default=False, verbose_name='Glaucoma')),
                ('dx_dry_eye', models.BooleanField(default=False, verbose_name='Ojo Seco')),
                ('dx_conjunctivitis', models.BooleanField(default=False, verbose_name='Conjuntivitis')),
                ('dx_keratoconus', models.BooleanField(default=False, verbose_name='Queratocono')),
                ('treatment_plan', models.TextField(blank=True, verbose_name='Plan de Tratamiento')),
                ('prescription_glasses', models.BooleanField(default=False, verbose_name='Prescripción de Lentes')),
                ('prescription_contact_lenses', models.BooleanField(default=False, verbose_name='Prescripción de LC')),
                ('prescription_medication', models.BooleanField(default=False, verbose_name='Prescripción de Medicamentos')),
                ('medication_details', models.TextField(blank=True, verbose_name='Detalles de Medicación')),
                ('lens_type', models.CharField(blank=True, choices=[('single', 'Monofocales'), ('bifocal', 'Bifocales'), ('progressive', 'Progresivos'), ('occupational', 'Ocupacionales'), ('reading', 'Lectura')], max_length=50, verbose_name='Tipo de Lentes')),
                ('lens_material', models.CharField(blank=True, help_text='Ej: CR-39, Policarbonato, Alto Índice', max_length=100, verbose_name='Material de Lentes')),
                ('lens_coating', models.CharField(blank=True, help_text='Ej: Antireflejo, Blue Block, Fotocromático', max_length=200, verbose_name='Tratamientos/Recubrimientos')),
                ('follow_up_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Seguimiento')),
                ('follow_up_notes', models.TextField(blank=True, verbose_name='Notas de Seguimiento')),
                ('observations', models.TextField(blank=True, verbose_name='Observaciones Generales')),
                ('recommendations', models.TextField(blank=True, verbose_name='Recomendaciones')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Última Actualización')),
                ('organization', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='clinicalhistory_set', to='organizations.organization', verbose_name='Organización')),
            ],
            options={
                'verbose_name': 'Historia Clínica',
                'verbose_name_plural': 'Historias Clínicas',
                'ordering': ['-date', '-created_at'],
            },
        ),
        migrations.AlterField(
            model_name='patient',
            name='account_number',
            field=models.CharField(blank=True, max_length=50, verbose_name='# Cuenta bancaria'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='bank_entity',
            field=models.CharField(blank=True, max_length=200, verbose_name='Entidad bancaria'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='business_address',
            field=models.TextField(blank=True, verbose_name='Dirección de empresa'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='business_name',
            field=models.CharField(blank=True, max_length=200, verbose_name='Nombre de empresa'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='business_phone',
            field=models.CharField(blank=True, max_length=17, verbose_name='Teléfono de empresa'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='business_type',
            field=models.CharField(blank=True, max_length=200, verbose_name='Tipo encadenado'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='civil_status',
            field=models.CharField(blank=True, max_length=50, verbose_name='Estado civil'),
        ),
        migrations.AlterField(
            model_name='patient',
            name='residence_area',
            field=models.CharField(blank=True, max_length=200, verbose_name='Zona de residencia'),
        ),
        migrations.CreateModel(
            name='ClinicalHistoryAttachment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', models.FileField(upload_to='clinical_histories/%Y/%m/', verbose_name='Archivo')),
                ('file_type', models.CharField(choices=[('retinography', 'Retinografía'), ('oct', 'OCT (Tomografía)'), ('topography', 'Topografía Corneal'), ('visual_field', 'Campo Visual'), ('prescription', 'Fórmula/Prescripción'), ('lab_result', 'Resultado de Laboratorio'), ('other', 'Otro')], max_length=50, verbose_name='Tipo de Archivo')),
                ('description', models.CharField(blank=True, max_length=200, verbose_name='Descripción')),
                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('clinical_history', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attachments', to='patients.clinicalhistory', verbose_name='Historia Clínica')),
                ('organization', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='clinicalhistoryattachment_set', to='organizations.organization', verbose_name='Organización')),
            ],
            options={
                'verbose_name': 'Archivo Adjunto',
                'verbose_name_plural': 'Archivos Adjuntos',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='clinicalhistory',
            name='patient',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='clinical_histories', to='patients.patient', verbose_name='Paciente'),
        ),
        migrations.AddIndex(
            model_name='clinicalhistory',
            index=models.Index(fields=['organization', 'patient', '-date'], name='patients_cl_organiz_f4b3b5_idx'),
        ),
        migrations.AddIndex(
            model_name='clinicalhistory',
            index=models.Index(fields=['organization', '-date'], name='patients_cl_organiz_b84cb2_idx'),
        ),
    ]
